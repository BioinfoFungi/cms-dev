{"version":3,"sources":["webpack:///./src/views/page/PageCreate.vue?aa2d","webpack:///src/views/page/PageCreate.vue","webpack:///./src/views/page/PageCreate.vue?6d19","webpack:///./src/views/page/PageCreate.vue","webpack:///./src/views/page/PageCreate.vue?5043","webpack:///./src/api/sheet.js"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","model","value","queryParam","callback","$$v","$set","expression","on","onChange","ref","staticStyle","change","imgAdd","imgDel","staticClass","save","_v","preview","showDrawer","openAttachement","visible","onClose","template","_e","handleChange","_l","item","key","id","enName","_s","name","submit","attachemnetVisible","gutter","column","attachments","scopedSlots","_u","fn","fileKey","path","$event","addToTextarea","nextPage","attachmentDetailsFlag","attachmentDetails","directives","rawName","handlePictureType","handleVideoType","handleMusicType","staticRenderFns","components","mavonEditor","data","originalContent","templateName","title","viewName","status","isSource","templates","undefined","isUpdate","sheetId","img_file","beforeRouteEnter","next","articleId","sheet","vm","article","haveHtml","loadTemplate","destroyed","removejscssfile","mounted","methods","loadAttachment","attachment","formdata","FormData","append","$file","pos","upload","formatContent","message","response","resource","JSON","parse","css","forEach","dynamicLoad","js","filter","base","window","open","checked","mediaType","prefix","split","component","baseUrl","sheetApi","param","service","url","params","method"],"mappings":"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","file":"js/PageCreate.ff48d0ec.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('div',[_c('a-input',{attrs:{\"placeholder\":\"请输入标题\"},model:{value:(_vm.queryParam.title),callback:function ($$v) {_vm.$set(_vm.queryParam, \"title\", $$v)},expression:\"queryParam.title\"}}),_c('a-switch',{on:{\"change\":_vm.onChange},model:{value:(_vm.queryParam.isSource),callback:function ($$v) {_vm.$set(_vm.queryParam, \"isSource\", $$v)},expression:\"queryParam.isSource\"}}),_c('mavon-editor',{ref:\"md\",staticStyle:{\"min-height\":\"600px\",\"z-index\":\"1\"},on:{\"change\":_vm.change,\"imgAdd\":_vm.imgAdd,\"imgDel\":_vm.imgDel},model:{value:(_vm.queryParam.originalContent),callback:function ($$v) {_vm.$set(_vm.queryParam, \"originalContent\", $$v)},expression:\"queryParam.originalContent\"}}),_c('div',{staticClass:\"article-bottom\"},[_c('div',{staticClass:\"article-option\"},[_c('a-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.save}},[_vm._v(\"保存\")]),_c('a-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.preview}},[_vm._v(\"预览\")]),_c('a-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.showDrawer}},[_vm._v(\"打开发布面板\")]),_c('a-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.openAttachement}},[_vm._v(\"附件库\")])],1)]),_c('a-drawer',{attrs:{\"title\":\"创建或跟新页面\",\"placement\":\"right\",\"closable\":false,\"visible\":_vm.visible,\"width\":\"30rem\"},on:{\"close\":_vm.onClose}},[_c('a-form-item',{attrs:{\"label\":\"页面名称\"}},[_c('a-input',{model:{value:(_vm.queryParam.title),callback:function ($$v) {_vm.$set(_vm.queryParam, \"title\", $$v)},expression:\"queryParam.title\"}})],1),(_vm.template)?_c('a-form-item',{attrs:{\"label\":\"资源\"}},[_c('a-textarea',{model:{value:(_vm.template.resource),callback:function ($$v) {_vm.$set(_vm.template, \"resource\", $$v)},expression:\"template.resource\"}})],1):_vm._e(),_c('a-form',[_c('a-form-item',{attrs:{\"label\":\"视图路径\"}},[_c('a-input',{attrs:{\"placeholder\":\"请输入视图路径\"},model:{value:(_vm.queryParam.viewName),callback:function ($$v) {_vm.$set(_vm.queryParam, \"viewName\", $$v)},expression:\"queryParam.viewName\"}})],1),_c('a-form-item',{attrs:{\"label\":\"选择模板\"}},[_c('a-select',{staticStyle:{\"width\":\"100%\"},on:{\"change\":_vm.handleChange},model:{value:(_vm.queryParam.templateName),callback:function ($$v) {_vm.$set(_vm.queryParam, \"templateName\", $$v)},expression:\"queryParam.templateName\"}},_vm._l((_vm.templates),function(item){return _c('a-select-option',{key:item.id,attrs:{\"value\":item.enName}},[_vm._v(_vm._s(item.name))])}),1)],1),_c('a-form-item',[_c('a-button',{on:{\"click\":_vm.submit}},[_vm._v(\"发布\")])],1)],1)],1),_c('a-drawer',{attrs:{\"title\":\"附件库\",\"placement\":\"right\",\"closable\":false,\"visible\":_vm.attachemnetVisible,\"width\":\"30rem\"},on:{\"close\":function () {\n          _vm.attachemnetVisible = false;\n        }}},[_c('a-list',{attrs:{\"grid\":{ gutter: 16, column: 2 },\"dataSource\":_vm.attachments},scopedSlots:_vm._u([{key:\"renderItem\",fn:function(item){return _c('a-list-item',{},[_c('a-card',{attrs:{\"title\":item.fileKey}},[_c('img',{attrs:{\"src\":item.path,\"width\":\"100%\",\"height\":\"100px\"}}),_c('a',{attrs:{\"href\":\"javascript:;\"},on:{\"click\":function($event){return _vm.addToTextarea(item)}}},[_vm._v(\"详情\")])])],1)}}])}),_c('a-button',{on:{\"click\":function($event){return _vm.nextPage(-1)}}},[_vm._v(\"上一页\")]),_c('a-button',{on:{\"click\":function($event){return _vm.nextPage(1)}}},[_vm._v(\"下一页\")])],1),_c('a-modal',{attrs:{\"title\":\"附件详情\"},model:{value:(_vm.attachmentDetailsFlag),callback:function ($$v) {_vm.attachmentDetailsFlag=$$v},expression:\"attachmentDetailsFlag\"}},[(_vm.attachmentDetails)?_c('a-form',[_c('a-form-item',{attrs:{\"label\":\"路径\"}},[_c('a-input',{model:{value:(_vm.attachmentDetails.path),callback:function ($$v) {_vm.$set(_vm.attachmentDetails, \"path\", $$v)},expression:\"attachmentDetails.path\"}})],1),_c('a-form-item',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.handlePictureType(_vm.attachmentDetails)),expression:\"handlePictureType(attachmentDetails)\"}],attrs:{\"label\":\"ThumbPath\"}},[_c('a-input',{model:{value:(_vm.attachmentDetails.thumbPath),callback:function ($$v) {_vm.$set(_vm.attachmentDetails, \"thumbPath\", $$v)},expression:\"attachmentDetails.thumbPath\"}})],1),(_vm.handleVideoType(_vm.attachmentDetails))?_c('div',[_c('video',{staticStyle:{\"width\":\"100%\"},attrs:{\"src\":_vm.attachmentDetails.path,\"controls\":\"\"}})]):_vm._e(),(_vm.handlePictureType(_vm.attachmentDetails))?_c('div',[_c('img',{staticStyle:{\"width\":\"100%\"},attrs:{\"src\":_vm.attachmentDetails.path,\"controls\":\"\"}})]):_vm._e(),(_vm.handleMusicType(_vm.attachmentDetails))?_c('div',[_c('audio',{staticStyle:{\"width\":\"100%\"},attrs:{\"src\":_vm.attachmentDetails.path,\"controls\":\"\"}})]):_vm._e()],1):_vm._e()],1)],1)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div>\n    <div>\n      <a-input placeholder=\"请输入标题\" v-model=\"queryParam.title\" />\n      <a-switch v-model=\"queryParam.isSource\" @change=\"onChange\" />\n\n      <mavon-editor\n        v-model=\"queryParam.originalContent\"\n        ref=\"md\"\n        @change=\"change\"\n        style=\"min-height: 600px; z-index: 1\"\n        @imgAdd=\"imgAdd\"\n        @imgDel=\"imgDel\"\n      />\n      <!-- <a-form-item label=\"输入CSS\">\n        <a-input type=\"textarea\" v-model=\"queryParam.cssContent\"></a-input>\n      </a-form-item>\n\n      <a-form-item label=\"输入JS\">\n        <a-input type=\"textarea\" v-model=\"queryParam.jsContent\"></a-input>\n      </a-form-item> -->\n\n      <div class=\"article-bottom\">\n        <div class=\"article-option\">\n          <a-button type=\"primary\" @click=\"save\">保存</a-button>\n          <a-button type=\"primary\" @click=\"preview\">预览</a-button>\n          <a-button type=\"primary\" @click=\"showDrawer\">打开发布面板</a-button>\n          <a-button type=\"primary\" @click=\"openAttachement\">附件库</a-button>\n        </div>\n      </div>\n\n      <a-drawer\n        title=\"创建或跟新页面\"\n        placement=\"right\"\n        :closable=\"false\"\n        @close=\"onClose\"\n        :visible=\"visible\"\n        width=\"30rem\"\n      >\n        <a-form-item label=\"页面名称\">\n          <a-input v-model=\"queryParam.title\"></a-input>\n        </a-form-item>\n        <a-form-item label=\"资源\" v-if=\"template\">\n          <a-textarea v-model=\"template.resource\" />\n        </a-form-item>\n        <a-form>\n          <a-form-item label=\"视图路径\">\n            <a-input\n              placeholder=\"请输入视图路径\"\n              v-model=\"queryParam.viewName\"\n            />\n          </a-form-item>\n\n          <a-form-item label=\"选择模板\">\n            <a-select\n              style=\"width: 100%\"\n              v-model=\"queryParam.templateName\"\n              @change=\"handleChange\"\n            >\n              <a-select-option\n                :value=\"item.enName\"\n                v-for=\"item in templates\"\n                :key=\"item.id\"\n                >{{ item.name }}</a-select-option\n              >\n            </a-select>\n          </a-form-item>\n\n          <a-form-item>\n            <a-button @click=\"submit\">发布</a-button>\n          </a-form-item>\n        </a-form>\n      </a-drawer>\n\n      <a-drawer\n        title=\"附件库\"\n        placement=\"right\"\n        :closable=\"false\"\n        @close=\"\n          () => {\n            attachemnetVisible = false;\n          }\n        \"\n        :visible=\"attachemnetVisible\"\n        width=\"30rem\"\n      >\n        <a-list :grid=\"{ gutter: 16, column: 2 }\" :dataSource=\"attachments\">\n          <a-list-item slot=\"renderItem\" slot-scope=\"item\">\n            <a-card :title=\"item.fileKey\">\n              <img :src=\"item.path\" width=\"100%\" height=\"100px\" />\n              <a href=\"javascript:;\" @click=\"addToTextarea(item)\">详情</a>\n            </a-card>\n          </a-list-item>\n        </a-list>\n        <a-button @click=\"nextPage(-1)\">上一页</a-button>\n        <a-button @click=\"nextPage(1)\">下一页</a-button>\n      </a-drawer>\n\n      <a-modal title=\"附件详情\" v-model=\"attachmentDetailsFlag\">\n        <a-form v-if=\"attachmentDetails\">\n          <a-form-item label=\"路径\">\n            <a-input v-model=\"attachmentDetails.path\"></a-input>\n          </a-form-item>\n          <a-form-item\n            label=\"ThumbPath\"\n            v-show=\"handlePictureType(attachmentDetails)\"\n          >\n            <a-input v-model=\"attachmentDetails.thumbPath\"></a-input>\n          </a-form-item>\n          <div v-if=\"handleVideoType(attachmentDetails)\">\n            <video\n              :src=\"attachmentDetails.path\"\n              controls\n              style=\"width: 100%\"\n            ></video>\n          </div>\n          <div v-if=\"handlePictureType(attachmentDetails)\">\n            <img :src=\"attachmentDetails.path\" controls style=\"width: 100%\" />\n          </div>\n          <div v-if=\"handleMusicType(attachmentDetails)\">\n            <audio\n              :src=\"attachmentDetails.path\"\n              controls\n              style=\"width: 100%\"\n            ></audio>\n          </div>\n        </a-form>\n      </a-modal>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { mavonEditor } from \"mavon-editor\";\nimport \"mavon-editor/dist/css/index.css\";\nimport templateApi from \"@/api/template.js\";\n// import templateApi from \"@/api/template.js\";\nimport preview from \"@/api/preview.js\";\nimport uploadApi from \"@/api/upload.js\";\nimport attachmentApi from \"@/api/attachment.js\";\n\nimport sheetApi from \"@/api/sheet.js\";\nimport dynamicLoad from \"@/utils/dynamicLoad.js\";\n\nexport default {\n  // 注册\n  components: {\n    mavonEditor,\n  },\n  data() {\n    return {\n      queryParam: {\n        originalContent: \"\", // 输入的markdown\n        templateName: \"\",\n        title: \"\",\n        viewName: \"\",\n        status: \"PUBLISHED\",\n        // cssContent: \"\",\n        // jsContent: \"\",\n        isSource: false,\n      },\n      visible: false,\n      templates: [],\n      template: undefined,\n      isUpdate: false,\n      sheetId: null,\n      img_file: {},\n      attachments: [],\n      attachemnetVisible: false,\n      attachmentDetailsFlag: false,\n      attachmentDetails: null,\n    };\n  },\n\n  beforeRouteEnter(to, from, next) {\n    // Get post id from query\n    const articleId = to.query.sheetId;\n    next((vm) => {\n      if (articleId) {\n        sheetApi.findById(articleId).then((response) => {\n          const article = response.data.data;\n          // console.log(article);\n          vm.queryParam.originalContent = article.originalContent; // 输入的markdown\n          vm.queryParam.haveHtml = article.haveHtml;\n          vm.sheetId = article.id;\n          vm.queryParam.templateName = article.templateName;\n          // vm.queryParam.cssContent = article.cssContent;\n          // vm.queryParam.jsContent = article.jsContent;\n          vm.queryParam.title = article.title;\n          vm.queryParam.viewName = article.viewName;\n          vm.queryParam.status = article.status;\n          vm.queryParam.isSource = article.isSource;\n          //     tagIds: []\n          // categoryIds: []\n          vm.isUpdate = true;\n          vm.loadTemplate(article.templateName);\n          // console.log(article.templateName)\n        });\n      }\n    });\n  },\n  destroyed() {\n    this.removejscssfile();\n  },\n  mounted() {\n    if (!this.isUpdate) {\n      this.loadTemplate();\n    }\n  },\n  methods: {\n    loadAttachment() {\n      attachmentApi.list(this.pagination).then((resp) => {\n        // console.log(resp);\n        this.attachments = resp.data.data.content;\n      });\n    },\n    imgAdd(pos, $file) {\n      var formdata = new FormData();\n      formdata.append(\"file\", $file);\n      this.img_file[pos] = $file;\n      uploadApi.upload(formdata).then((response) => {\n        // console.log(response.data.data.path);\n        this.$refs.md.$img2Url(pos, response.data.data.thumbPath);\n      });\n    },\n    imgDel() {},\n    // 所有操作都会被解析重新渲染\n    change(value, render) {\n      // render 为 markdown 解析后的结果[html]\n      this.queryParam.formatContent = render;\n    },\n    // 提交\n    submit() {\n      // if (!this.queryParam.channelId) {\n      //   this.$notification[\"error\"]({\n      //     message: \"请选择一个栏目\"\n      //   });\n      //   return;\n      // }\n      if (this.isUpdate) {\n        sheetApi\n          .update(this.$route.query.sheetId, this.queryParam)\n          .then((response) => {\n            // console.log(response);\n\n            this.$notification[\"success\"]({\n              message: \"更新成功:\" + response.data.message,\n            });\n\n            this.$router.push({ name: \"PageList\" });\n          });\n      } else {\n        // console.log(this.queryParam);\n        sheetApi.create(this.queryParam).then((response) => {\n          // console.log(response);\n          this.$notification[\"success\"]({\n            message: \"添加成功\" + response.data.message,\n          });\n          this.$router.push({ name: \"PageList\" });\n        });\n      }\n    },\n    showDrawer() {\n      this.visible = true;\n      // console.log(this.queryParam.templateName);\n    },\n    onClose() {\n      this.visible = false;\n    },\n    removejscssfile() {\n      if (this.template) {\n        // this.templateCurr=undefined\n\n        if (this.template && this.template.resource) {\n          let resource = this.template.resource;\n          resource = JSON.parse(resource);\n          // console.log(resource);\n          // console.log(resource);\n          if (resource.css) {\n            resource.css.forEach((item) => {\n              dynamicLoad.removejscssfile(item, \"css\");\n            });\n          }\n          if (resource.js) {\n            resource.js.forEach((item) => {\n              dynamicLoad.removejscssfile(item, \"js\");\n            });\n          }\n        }\n      }\n    },\n    handleChange(value) {\n      // let items = {};\n      // this.templates.forEach((item) => {\n      //   // console.log(item)\n      //   items[item.enName] = item;\n      // });\n      // // console.log(this.templates)\n      // console.log(items[value]);\n      // // console.log(value);\n      this.removejscssfile();\n      this.template = this.templates.filter((item) => item.enName == value)[0];\n      if (!this.isUpdate) {\n        // console.log(this.template)\n        if (this.template && this.template.base) {\n          this.queryParam.originalContent = this.template.base;\n        }else {\n          this.queryParam.originalContent=\"\"\n        }\n      }\n\n      if (this.template && this.template.resource) {\n        let resource = this.template.resource;\n        resource = JSON.parse(resource);\n        // console.log(resource);\n        if (resource.css) {\n          resource.css.forEach((item) => {\n            // console.log(item);\n            dynamicLoad.css(dynamicLoad.addPrefix(item));\n          });\n        }\n        if (resource.js) {\n          resource.js.forEach((item) => {\n            // console.log(item);\n            dynamicLoad.js(dynamicLoad.addPrefix(item));\n          });\n        }\n      }\n    },\n    loadTemplate(name) {\n      templateApi.findByType(\"SHEET\").then((response) => {\n        this.templates = response.data.data;\n        if (name) {\n          this.handleChange(name);\n        }\n\n        // console.log(response);\n      });\n    },\n    preview() {\n      //  console.log(this.sheetId);\n      if (!this.sheetId) {\n        sheetApi.saveSheet(this.queryParam).then((response) => {\n          this.sheetId = response.data.data.id;\n\n          this.$notification[\"success\"]({\n            message: \"预览之前保存文章\" + response.data.message,\n          });\n\n          //          console.log(this.sheetId)\n          // console.log(this.queryParam)\n          window.open(preview.Online(\"sheet\", this.sheetId), \"_blank\");\n\n          // this.$router.push(\"/article/list\");\n        });\n      } else {\n        window.open(preview.Online(\"sheet\", this.sheetId), \"_blank\");\n      }\n    },\n    save() {\n      // console.log(this.sheetId)\n      // if (!this.queryParam.categoryId) {\n      //   this.$notification[\"error\"]({\n      //     message: \"文章类别不能为空!!\"\n      //   });\n      //   return;\n      // }\n      // if (!this.queryParam.title) {\n      //   this.$notification[\"error\"]({\n      //     message: \"文章标题不能为空!!\"\n      //   });\n      //   return;\n      // }\n      // if (!this.queryParam.originalContent) {\n      //   this.$notification[\"error\"]({\n      //     message: \"文章内容不能为空!!\"\n      //   });\n      //   return;\n      // }\n      // if (!this.queryParam.userId) {\n      //   this.$notification[\"error\"]({\n      //     message: \"文章用户不能为空!!\"\n      //   });\n      //   return;\n      // }\n\n      if (this.isUpdate) {\n        sheetApi.modifySheet(this.sheetId, this.queryParam).then((response) => {\n          this.sheetId = response.data.data.id;\n          this.$notification[\"success\"]({\n            message: \"更新页面成功:\" + response.data.message,\n          });\n        });\n      } else {\n        sheetApi.saveSheet(this.queryParam).then((response) => {\n          this.sheetId = response.data.data.id;\n          this.isUpdate = true;\n          this.$router.replace({ query: { sheetId: this.sheetId } });\n          this.$notification[\"success\"]({\n            message: \"保存页面\" + response.data.message,\n          });\n        });\n      }\n    },\n    onChange(checked) {\n      // console.log(`a-switch to ${checked}`);\n      this.queryParam.isSource = checked;\n    },\n    openAttachement() {\n      this.attachemnetVisible = true;\n      this.loadAttachment();\n    },\n    addToTextarea(item) {\n      this.attachmentDetailsFlag = true;\n      // console.log(item);\n      this.attachmentDetails = item;\n    },\n    handlePictureType(attachment) {\n      var mediaType = attachment.mediaType;\n      // 判断文件类型\n      if (mediaType) {\n        var prefix = mediaType.split(\"/\")[0];\n\n        if (prefix === \"image\") {\n          // 是图片\n          return true;\n        } else {\n          // 非图片\n          return false;\n        }\n      }\n      // 没有获取到文件返回false\n      return false;\n    },\n    handleMusicType(attachment) {\n      var mediaType = attachment.mediaType;\n      // 判断文件类型\n      if (mediaType) {\n        var prefix = mediaType.split(\"/\")[0];\n\n        if (prefix === \"audio\") {\n          // 是音乐\n          return true;\n        } else {\n          // 非图片\n          return false;\n        }\n      }\n      // 没有获取到文件返回false\n      return false;\n    },\n    handleVideoType(attachment) {\n      var mediaType = attachment.mediaType;\n      // 判断文件类型\n      if (mediaType) {\n        var prefix = mediaType.split(\"/\")[0];\n\n        if (prefix === \"video\") {\n          // 是音乐\n          return true;\n        } else {\n          // 非图片\n          return false;\n        }\n      }\n      // 没有获取到文件返回false\n      return false;\n    },\n  },\n};\n</script>\n\n<style>\n.article-bottom {\n  position: fixed;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  height: 4rem;\n  background: #fff;\n  z-index: 5;\n}\n.article-option {\n  float: right;\n  position: relative;\n  top: 1rem;\n  right: 2rem;\n}\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PageCreate.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PageCreate.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./PageCreate.vue?vue&type=template&id=26b01714&\"\nimport script from \"./PageCreate.vue?vue&type=script&lang=js&\"\nexport * from \"./PageCreate.vue?vue&type=script&lang=js&\"\nimport style0 from \"./PageCreate.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PageCreate.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PageCreate.vue?vue&type=style&index=0&lang=css&\"","import service from '@/utils/service'\nconst baseUrl = '/api/sheet'\n\nconst sheetApi = {}\n\nsheetApi.list=(param)=>{\n    return service({\n        url:baseUrl,\n        params: param,\n        method:\"get\"\n    })\n}\nsheetApi.addOrRemoveToMenu=id=>{\n    return service({\n      url:`${baseUrl}/addOrRemoveToMenu/${id}`,\n      method:'get'\n    })\n  }\n\nsheetApi.findListByChannelId =id => {\n    return service({\n        url: `${baseUrl}/findListByChannelId/${id}`,\n        method: 'get'\n    })\n  }\nsheetApi.deleteById=(id) => {\n    return service({\n        url: `${baseUrl}/delete/${id}`,\n        method: 'get'\n    })\n}\n\nsheetApi.generateHtml=(id) => {\n    return service({\n        url: `${baseUrl}/generate/${id}`,\n        method: 'get'\n    })\n}\nsheetApi.query = (params) => {\n    return service({\n        url: baseUrl,\n        params: params,\n        method: 'get'\n    })\n}\nsheetApi.findById = (sheetId) => {\n    return service({\n        url: `${baseUrl}/find/${sheetId}`,\n        method: 'get'\n    })\n}\nsheetApi.create = (params) => {\n    return service({\n        url: baseUrl,\n        data: params,\n        method: 'post'\n    })\n}\n\nsheetApi.saveSheet = (params) => {\n    return service({\n        url: `${baseUrl}/save`,\n        data: params,\n        method: 'post'\n    })\n}\nsheetApi.modifySheet = (id,params) => {\n    return service({\n        url: `${baseUrl}/save/${id}`,\n        data: params,\n        method: 'post'\n    })\n}\n\nsheetApi.update = (id,params) => {\n    return service({\n        url: `${baseUrl}/update/${id}`,\n        data: params,\n        method: 'post'\n    })\n}\nexport default sheetApi"],"sourceRoot":""}